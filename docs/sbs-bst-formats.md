# Socket Data and BST File Formats

This document provides a detailed description of the data formats used by `dump1090` and the BaseStation application, which are relevant for the `go-dump1090-timeseries-collector` project's parsing logic.

## 1. SBS-1 Socket Data (Port 30003)

The SBS-1 protocol sends comma-separated ASCII data strings over a TCP socket. The data stream contains various message types, with the most common being `MSG`.

**Raw Data Example:**

```text
STA,,5,179,400AE7,10103,2008/11/28,14:58:51.153,2008/11/28,14:58:51.153,RM
MSG,4,5,211,4CA2D6,10057,2008/11/28,14:53:49.986,2008/11/28,14:58:51.153,,,408.3,146.4,,,64,,,,,
MSG,3,5,211,4CA2D6,10057,2008/11/28,14:53:50.594,2008/11/28,14:58:51.153,,37000,,,51.45735,-1.02826,,,0,0,0,0
```

### Message Types

There are six primary message types. Most aircraft data is found in MSG lines.

| ID | Type | Description |
| --- | --- | --- |
| SEL | SELECTION CHANGE | Generated when the user changes the selected aircraft |
| ID | NEW ID MESSAGE | Generated when an aircraft sets or changes its callsign |
| AIR | NEW AIRCRAFT MESSAGE | Generated when a new aircraft signal is picked up |
| STA | STATUS CHANGE MESSAGE | Generated when an aircraft's status changes based on time-outs |
| CLK | CLICK MESSAGE | Generated when the user double-clicks on an aircraft |
| MSG | TRANSMISSION MESSAGE | Generated by the aircraft itself. There are eight subtypes |

### MSG Subtypes

| ID | Type | Description |
| --- | --- | --- |
| MSG,1 | ES Identification and Category | DF17 BDS 0,8 |
| MSG,2 | ES Surface Position | DF17 BDS 0,6. Triggered by nose gear squat switch |
| MSG,3 | ES Airborne Position | DF17 BDS 0,5 |
| MSG,4 | ES Airborne Velocity | DF17 BDS 0,9 |
| MSG,5 | Surveillance Alt Message | DF4, DF20. Triggered by ground radar. Not CRC secured |
| MSG,6 | Surveillance ID Message | DF5, DF21. Triggered by ground radar. Not CRC secured |
| MSG,7 | Air To Air Message | DF16. Triggered from TCAS |
| MSG,8 | All Call Reply | DF11. Broadcast but also triggered by ground radar |

### Field Data

Each message type contains up to 22 comma-separated data fields.

| Field | Name | Description |
| --- | --- | --- |
| 1 | Message type | MSG, STA, ID, AIR, SEL, or CLK |
| 2 | Transmission Type | MSG subtypes 1 to 8 |
| 3 | Session ID | Database Session record number |
| 4 | Aircraft ID | Database Aircraft record number |
| 5 | Hex Ident | Aircraft Mode S hexadecimal code |
| 6 | Flight ID | Database Flight record number |
| 7 | Date message generated | Date the message was generated by the aircraft |
| 8 | Time message generated | Time the message was generated by the aircraft |
| 9 | Date message logged | Date the message was logged by the receiver |
| 10 | Time message logged | Time the message was logged by the receiver |
| 11 | Callsign | An eight-digit flight ID (e.g., flight number or registration) |
| 12 | Altitude | Mode C altitude (Flight Level) |
| 13 | GroundSpeed | Speed over ground in knots |
| 14 | Track | Track of aircraft in degrees |
| 15 | Latitude | North and East positive |
| 16 | Longitude | North and East positive |
| 17 | Vertical Rate | Vertical speed in 64-foot resolution |
| 18 | Squawk | Assigned Mode A squawk code |
| 19 | Alert | Flag indicating squawk has changed |
| 20 | Emergency | Flag indicating an emergency code has been set |
| 21 | SPI (Ident) | Flag indicating transponder Ident has been activated |
| 22 | IsOnGround | Flag indicating the ground squat switch is active |

**Notes:**

-   The socket data outputs -1 for true and 0 for false

-   A single MSG type does not provide all fields. The MSG,1 message only contains data for fields 1-11, with the remaining fields being empty (represented by commas)

-   Callsign is an 8-character field. NULL is shown as @


## 2. BST Files (BaseStation Logs)
--------------------------------

The BST file format is a processed version of the data, containing 17 fields per line. Unlike raw socket data, each line is a snapshot of an aircraft's state, and all fields are populated using the last known values.

### Raw Data Example:

```text

"2018/07/05","02:44:34.126","9004131","896463","ETD44A","United Arab Emirates","0","39000","39000","52.05327","-3.81704","-64","-64","484.6","102.0","8726","2216"
"2018/07/05","02:44:34.142","4736069","484445","KLM656","Netherlands","0","41000","41000","55.11269","-3.75159","0","0","480.8","122.2","25347","6303"
```

### Field Data

| Field | Name | Description |
| --- | --- | --- |
| 1 | Date message generated | Date of the log entry |
| 2 | Time message generated | Time of the log entry |
| 3 | Mode S Code (Decimal) | Aircraft Mode S decimal code |
| 4 | Mode S Code (Hex) | Aircraft Mode S hexadecimal code |
| 5 | Callsign | An eight-digit flight ID |
| 6 | Country | Interpolated from the Mode S code using the Countries.dat file |
| 7 | IsOnGround | Flag indicating the ground squat switch is active |
| 8 | Altitude | Mode C altitude (Flight Level) |
| 9 | Altitude (Future Dev) | Placeholder for future development. Same data as Field 8 |
| 10 | Latitude | North and East positive |
| 11 | Longitude | North and East positive |
| 12 | Vertical Rate | Vertical speed in 64-foot resolution |
| 13 | Vertical Rate (Adjusted) | Adjusted data for BaseStation screen presentation |
| 14 | GroundSpeed | Speed over ground in knots |
| 15 | Track | Track of the aircraft in degrees |
| 16 | Squawk (Decimal) | Assigned Mode A squawk code in decimal format |
| 17 | Squawk (Octal) | Assigned Mode A squawk code in octal format (cockpit setting) |


## Credits

This documentation is based on extensive research and collaboration. My thanks go to the authors and contributors of the original documentation on the Kinetic forum and the following website:

-   [Barebones 42 Socket Data Format](http://woodair.net/sbs/article/barebones42_socket_data.htm)
